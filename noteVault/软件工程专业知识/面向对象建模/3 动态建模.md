# [第6章-动态建模](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197)

## 目标
 [Outline](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=1)
 -   掌握活动图、状态图、顺序图和协作图绘制方法
-   掌握动态建模的步骤
-   清楚在实际的建模中什么时候该使用状态图、活动图 顺序图和协作图等

### 什么是动态建模？
[Page 3](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=2)
-   lUML提供了状态图、活动图、顺序图和协作图来描述系统的结构和行为
-   状态图、活动图、顺序图和协作图则适合于==描述系统中的对象在执行期间 不同的时间点是如何动态交互的==
-   *一组对象为了实现一些功能而进行通信称之为交互*，可以通过状态图、活 动图、顺序图和协作图来描述系统的动态行为

---
## 活动图
[Page 4](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=3)
-   l活动图(Activity Diagram)显示活动动作及其结果，着重描述操作(方法)实现 中所完成的工作以及用例实例或对象中的活动
-   l活动是某件事情正在进行的状态，既可以是现实生活中正在进行的某一项工作，也 可以是软件系统某个类对象的一个操作
-   活动图与常用的程序流程图相似，它们的主要区别在于程序流程图一般用来表示串行过程，而活动图则可以用来表示并行过程
-   l描述了为了完成某一个目标需要做的活动及这些活动的执行顺序
-   l一种用于描述用例场景
-   l一种用于描述对象交互(协作图描述更好

### 活动图存在的问题
[Page 10](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=9)
-   即执行业务流程 的职责被遗漏了
-   业务的执行过程不是重要的，对象 的职责才是最重要的
-   l泳道，顾名思义，就像一个游泳运动员只能在一个泳道里比赛一样，一个对 象也只能在一个业务流程中担任一个(或一类)职责。泳道代表了一个特定 的类、人、部门、层次等对象的职责区

### 带泳道的活动图
 [Page 11](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=10)
 
 ### 活动图与流程图的区别
[Page 13](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=12)

-   UML中的活动图用来描述系统使用的活动、判定点和分支，与传统的流程图 的功能非常类似
-   传统的流程图所能表示的程序逻辑，大多数情况下也可以 使用活动图表示，但活动图与流程图有着本质的区别
-   *流程图着重描述处理过程，它的主要控制结构是顺序、分支和循环，各个 处理过程之间有严格的顺序和时间关系*
-   ==活动图描述的是对象活动的顺序关系所遵循的规则，它着重表现的是系统的行为，而非系统的处理过程==
-   活动图能够表示并发活动的情形，而流程图不能
-   ==活动图是面向对象的，而流程图是面向过程的==

---
## ==状态图==
[Page 15](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=14)
-   状态图(Statechart Diagram)是软件系统进行面向对象分析的一种常用 工具，它通过建立对象的生存周期模型(状态)来描述对象随时间变化的 动态行为
-   状态图主要用来描述对象、子系统、系统的生命周期。通过状态图可以了 解到一个对象所能到达的所有状态以及对象收到的事件(收到消息、超时 、错误和条件满足等)对对象状态的影响等
-   并不是对所有的对象都创建状态图，只有当行为的改变和状态有关时才创 建状态图
-   与类图、对象图和用例图不同，状态图只能对单个对象建立模型，而类图 、对象图和用例图可以对一个系统或一组类建立模型

[Page 16](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=15)

-   **状态图显示一个状态机**
-   **导致状态转换的事件和状态 转换引起的操作**
-   状态图通常只用于描述==单个对象==的行为
-   ==如果要描述对象间的交互，最好采用时序图或协作图==

[Page 17](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=16)
-   l最为核心的元素无外乎是两个:一个是==用圆角矩形表示的状态(初态和终态例外）== ;另一个则是在==状态之间的、包含一些文字描述的有向箭头线== 这些箭头线称为转换

[Page 18](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=17)
-   状态转换的五要素
-   ==很重要的状态图整体overview==

[阅读带有复杂转换的状态图](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=20)

[状态图的绘制（预定机票案例分析）](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=26)
-   绘制状态机图的理想步骤是:寻找主要的状态，确定状态之间的转 换，细化状态内的活动与转换，用复合状态来展开细节
-   总结一下，主要有四种状态:无预订、部分预订、预订完以及预订关闭

[Page 28](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=27)

-   确定状态间转换

 [Page 29](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=28)

-   细化状态机内的活动与转换

[Page 30](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=29)

-   ==使用复合状态==

[画状态图需要注意的几个问题](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=30)

-   通过状态图很难看到全局，系统的整体行为一定是通过多个状态机的结果来决定的
    
-   ==状态图是对单个对象的“放大 ，它说明对象所经历的状态变 化，强调单个对象内状态的变化==
    
-   状态视图是一个类对象所可能经历的所有历程的模型图。状态 图由对象的各个状态和连接这些状态的转换组成
    
-   状态的变迁原因要在图上说明清楚


[状态图的应用](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=31)
-   状态图的主要应用有两种 l 一是在对象生命周期内，对一个对象的整个活动状态建模 l 二是对反应型对象的行为建模
    
-   ***一个状态图只适合描述一类对象，不必对每一类对象都进行状 态建模，把状态建模和对象建模进行结合，通过状态图帮助发 现和定义对象的操作，通过定义对象的操作完善状态图***

---
## 顺序图
### 概念
[Page 33](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=32)

-   顺序图主要用于用例的逻辑建模，是显示对象之间交互的图，这些对象 是按时间顺序排列的
-   顺序图中显示的是参与交互的对象及对象之间消息交互的顺序
-   **顺序图是一个表，其中显示的对象沿X轴排列，而消息则沿Y轴按时间顺 序排列**

[类角色](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=34)
-   **如果对象的位置不在顶部，表示对象是在交互的过程中被创建的**
-   类角色(Class Role)代表顺序图中的对象在交互中所扮演的角色
-   位于顺序图顶部的对象代表类角色，一般代表实际的对象
-   顺序图中对象符号和对象图中对象所用的符号一样
- **对象的三种命名方式**

[生命线](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=35)
-   l 每个对象的底部 时间内的存在 生命线(Lifeline)是一条垂直的虚线，表示顺序图中的对象在一段
-   对象与生命线结合在一起称为**对象的生命线**
-   对象的生命线包含矩形的对象图标以及图标下面的生命线

[激活期](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=36)

-   激活(Activation)表示该对象被占用以完成某个任务 激活期
-   去激活指的是对象处于空闲状态、在等待消息
-   **在UML中，为了表示对象是激活的，可以将该对象的生命线拓宽为 矩形**

[消息](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=37)
-   消息(Message)定义的是对象之间某种形式的通信 它可以激发某个操作、唤起信号或导致目标对象的创建 或撤销
-   消息是两个对象之间的单路通信，从发送方到接收方的 控制信息流
-   消息可以是信号，也可以是调用

[分支与从属流](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=38)

-   分支是指从同一点发出的多个消息并指向不同的对象，根据条件是否互 斥，可以有条件和并行两种结构
    
-   从属流指的是从同一点发出多个消息指向同一个对象的不同生命线;比 如删除一个文件时，向文件系统发送一条消息，文件系统会根据保存或 删除消息条件的不同执行不同的生命线

[消息和消息发送](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=39)
-   在面向对象技术中，对象间的交互是通过对象间消息的传递来 完成的
-   消息和消息发送
-   在UML中有以下几种动作 Ø 调用:调用某个对象的一个操作。对象也可以给自己发送消息，引 起本地的操作调用 Ø 返回:给调用者返回一个值 Ø 发送:向对象发送一个信号 Ø 创建:创建一个对象 Ø 撤销:撤销一个对象，对象也可以撤销自己

## [顺序图中的消息类型](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=41)

-   消息类型
    
-   简单消息:不考虑同步或异步的问题的一种消息
    
-   同步消息: =调用消息
    
-   异步消息
    
-   返回消息
    

[Page 43](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=42)

-   若接收者无法在指定时间内接收, 则发送者放弃该消息. 超时消息:消息的发送者发出消息给接收者并按指定时间等待, 立即接收, 则发送者放弃该消息. 阻止消息:消息的发送者传递消息给接收者, 如果接收者无法

[Page 45](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=44)

-   顺序图中的结构化控制
    
-   序列性的消息能够很好地说明单一的、线性的序列，但是，通 常需要展示条件和循环，多个序列的并发知识。顺序图中用结 构化控制操作符来展示这种高能控制
    

[Page 46](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=45)

-   时间约束的表示
    
-   在顺序图上，如果消息的箭头和生命线垂直，那么表明立即发 送该消息
    
-   如果箭头是倾斜的，表明该消息的传送有一定的时间延迟，其 间可以传送其他消息


### [顺序图的构建](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=46)
-   1. 确定交互过程的上下文(context 即工作流
    
-   2. 识别参与交互过程的对象，即从左到右布置对象
    
-   3. 为每个对象设置生命线，即确定哪些对象存在于整个 交互过程中，哪些对象在交互过程中被创建和撤消
    
-   4. 从引发这个交互过程的初始消息开始，在生命线之间 自顶向下依次画出随后的各个消息，即添加消息和条 件以便创造每一个工作流

-   5. 如果需要表示消息的嵌套，和/或表示消息发生时时间 点，则采用控制焦点
    
-   6. 如果需要说明时间约束，在消息旁边加上约束说明
    
-   7. 如果需要，可为每个消息附上前置条件和后置条件
    
-   8. 根据消息之间的关系，确定循环结构及循环参数和出 口条件

---
## 协作图
[协作图](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=49)

-   协作图也叫通信图或合作图，是UML动态模型图的另一种表现形式，是强调发送和接受消息的对象的结构组织的交 互图
    
-   协作图只对相互间有交互作用的对象和这些对象间的关系 建模，而忽略了其他对象和关联
-   ==协作图是描述系统行为是如何由系统的成分协作实现的==

[协作图-注意事项](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=50)

-   在协作图中，为了说明交互过 程中消息的时间顺序，需要给 消息添加顺序号——由1开始 递增的整数，每个消息都必须 有唯一的顺序号
    
-   在协作图中，多对象指由多个 对象组成的对象集合，一般是 属于同一类的。用于需要把消 息同时发送给多个对象而不是 单个对象时。多对象用多个方 框的重叠表示

### [协作图中的元素](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=51)
-   协作图中包括如下元素:类元素，关联元素和消息流
    
-   1)类角色(Class Role
    
-   2)关联角色(Association Role
    
-   3)消息流(Message Flow

### [协作图的构建](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=54)
-   建立协作图的指导性原则


## ## [顺序图与协作图的区别](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=56)
-   的动态关系 顺序图和协作图都属于交互图，都用于描述系统中对象之间
    
-   顺序图着重描述对象按照时间顺序的消息交换，并且把用例 行为分配给类
    
-   协作图着重描述系统成分如何协同工作，强调对象间的结构 关系
    
-   顺序图和协作图从不同的角度表达了系统中的交互和系统的 行为
    
-   顺序图有对象生命线和控制焦点，协作图中没有
    
-   协作图中有路径，并且协作图中的消息必须要有消息序列号 顺序图中没有要求

## [常见问题分析](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=57)

-   如何在顺序图中表示消息的循环发送?
    
-   在消名前加循环条件，例
 [Page 59](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=58)

-   如何在顺序图中表示消息的条件发送?

[Page 60](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=59)

-   (3) 如何在顺序图表示时间约束?
    
-   可以使用UML的3种扩展机制之一——约束(constraint)来表示
    
 [Page 61](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=60)

-   4) 如何在顺序图中表示递归?

 [Page 62](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=61)

-   (5) 顺序图中对象如何确定?
    
-   顺序图中的对象的确定需要参考类图, 类图中的类的确定 也需要参考顺序图, 二者相互补充、相互协调的关系.
    
-   顺序图与类图是否同时生成并交互修改?
    
-   在分析阶段, 顺序图中的消息名可能只是一个说明, 而在设 计阶段, 顺序图的消息名被细化, 最后对应到类图中的方法.

## [Page 64](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=63)

-   ==自己独立尝试画一下==

## [Page 68](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=67)

-   ==也是自己独立画一下==

## [小结](x-devonthink-item://AAA3F01D-5572-47E7-B604-288CC513A197?page=70)

-   静态视图表达事物的结构性特点，而动态视图则表达事物的行为性观点
    
-   一个好的建模，结构性与行为性缺一不可，而且要相得益彰。既要说明事物的样子，也要说明事物该怎么用
